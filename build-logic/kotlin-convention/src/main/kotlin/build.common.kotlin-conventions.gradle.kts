plugins {
    kotlin("jvm")
    id("com.adarshr.test-logger")
    id("com.ncorti.ktfmt.gradle")
}

// ---------------------------------------------------------------------------------------------------------------------
// Kotlin config
// ---------------------------------------------------------------------------------------------------------------------

kotlin {
    jvmToolchain {
        this.languageVersion.set(JavaLanguageVersion.of(11))
        this.vendor.set(JvmVendorSpec.ADOPTIUM)
    }
}

// ---------------------------------------------------------------------------------------------------------------------
// Repositories
// ---------------------------------------------------------------------------------------------------------------------

repositories { mavenCentral() }

// ---------------------------------------------------------------------------------------------------------------------
// Kotlin formatter
// ---------------------------------------------------------------------------------------------------------------------

ktfmt { kotlinLangStyle() }

tasks.register("checkFormat") {
    group = "verification"
    dependsOn(tasks.ktfmtCheck)
}

tasks.register("format") {
    group = "formatting"
    dependsOn(tasks.ktfmtFormat)
}

tasks.check { dependsOn("checkFormat") }

// ---------------------------------------------------------------------------------------------------------------------
// Testing config
// ---------------------------------------------------------------------------------------------------------------------

tasks.withType<Test> { useJUnitPlatform() }
